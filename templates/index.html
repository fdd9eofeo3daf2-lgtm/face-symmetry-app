<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI精密骨格診断：100点満点方式</title>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #121212; color: #e0e0e0; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 20px; }
        .container { background: #1e1e1e; padding: 2rem; border-radius: 28px; box-shadow: 0 25px 50px rgba(0,0,0,0.6); text-align: center; width: 100%; max-width: 480px; }
        h1 { font-size: 1.4rem; color: #00d2ff; margin-bottom: 1.5rem; }
        .upload-section { background: #262626; padding: 1.5rem; border-radius: 20px; border: 1px solid #444; margin-bottom: 2rem; }
        .btn { background: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%); color: white; border: none; padding: 1rem; border-radius: 12px; cursor: pointer; font-size: 1rem; font-weight: bold; width: 100%; margin-top: 1rem; }
        
        .score-box { margin: 1.5rem 0; }
        .score-num { font-size: 4.5rem; font-weight: 900; color: #00d2ff; }
        
        .deduction-list { text-align: left; background: #262626; border-radius: 16px; padding: 15px; margin: 1.5rem 0; }
        .list-header { font-size: 0.8rem; color: #00d2ff; border-bottom: 1px solid #444; padding-bottom: 8px; margin-bottom: 10px; display: flex; justify-content: space-between; }
        .item { margin-bottom: 12px; }
        .item-main { display: flex; justify-content: space-between; align-items: center; }
        .part-name { font-size: 0.9rem; font-weight: bold; }
        .minus-points { color: #ff4b2b; font-weight: bold; }
        .reason-text { font-size: 0.75rem; color: #888; }
        
        .status-critical { color: #ff4b2b !important; }
        .status-warning { color: #ffcc00 !important; }
        .status-good { color: #00ffaa !important; }

        .analysis-img { width: 100%; border-radius: 16px; border: 1px solid #444; margin-top: 1rem; }
    </style>
</head>
<body>
    <div class="container">
        <h1>AI SKELETAL ANALYZER</h1>
        
        <form method="POST" enctype="multipart/form-data">
            <div class="upload-section">
                <input type="file" name="file" accept="image/*" required>
                <button type="submit" class="btn">精密スキャン開始</button>
            </div>
        </form>

        {% if score is not none %}
            <div class="score-box">
                <p style="margin:0; font-size:0.9rem; color:#888;">対称性バランススコア</p>
                <span class="score-num">{{ score }}</span><span style="color:#00d2ff; font-weight:bold;"> / 100</span>
            </div>
            
            <div class="deduction-list">
                <div class="list-header">
                    <span>解析部位 / 詳細要因</span>
                    <span>減点</span>
                </div>
                {% for item in details %}
                <div class="item">
                    <div class="item-main">
                        <span class="part-name">{{ item.name }}</span>
                        <span class="minus-points">{% if item.deduction > 0 %}-{{ item.deduction }}{% else %}±0{% endif %}</span>
                    </div>
                    <div class="reason-text status-{{ item.status }}">{{ item.reason }}</div>
                </div>
                {% endfor %}
            </div>
            
            <img src="{{ url_for('uploaded_file', filename=result_img) }}" class="analysis-img">
            <p style="font-size: 0.7rem; color: #555; margin-top: 15px;">※100点満点からの部位別減点方式を採用しています</p>
        {% endif %}
    </div>
</body>
</html>